SQL 练习题解：牛客 SQL200 第 6-7 题
题目一：统计薪水记录超过15条的员工
问题描述
查找薪水记录超过15条的员工号 emp_no 以及其对应的记录次数 t。

解题思路
使用 GROUP BY 按员工号分组

使用 COUNT() 统计每个员工的记录数

使用 HAVING 筛选记录数大于15的结果

SQL 代码
sql
SELECT
    emp_no,
    COUNT(emp_no) AS t
FROM
    salaries
GROUP BY
    emp_no
HAVING
    COUNT(emp_no) > 15;
关键知识点
GROUP BY：用于分组聚合

COUNT()：聚合函数，统计行数

HAVING：对分组后的结果进行筛选（与 WHERE 的区别：WHERE 在分组前筛选，HAVING 在分组后筛选）

题目二：查找所有员工当前薪水并去重排序
问题描述
找出所有员工具体的薪水 salary 情况，对于相同的薪水只显示一次，并按照逆序显示。

解题思路
使用 DISTINCT 去重，确保相同的薪水只显示一次

使用 WHERE 子句筛选当前有效薪水（to_date = '9999-01-01'）

使用 ORDER BY 按薪水降序排列

SQL 代码
sql
SELECT DISTINCT
    salary
FROM
    salaries
WHERE
    to_date = '9999-01-01'
ORDER BY
    salary DESC;
关键知识点
DISTINCT：去重关键字，确保结果唯一

WHERE：条件筛选

ORDER BY ... DESC：降序排列（ASC 为升序）